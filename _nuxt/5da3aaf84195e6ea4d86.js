(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1089:function(e,t,r){"use strict";r.r(t);r(138),r(224),r(295),r(124),r(62);var n,o,c,l,d,m,f,k,T,h,E,v,y,w,S,x,A,O,_,R=r(1),N=(r(139),r(140),r(63),r(25)),C=r(5),I=r(526),P=r(527),j=(r(304),r(327),{allowanceNumber:function(e){var t=0;try{t=Object(C.a)(e.allowance).div(Object(C.a)(10).pow(e.tokenSelected.decimals)).toString(10)}catch(e){console.info(e)}return t},balanceNumber:function(e){var t=0;try{t=Object(C.a)(e.balance).div(Object(C.a)(10).pow(e.tokenSelected.decimals)).toString(10)}catch(e){}return t},tokenInstance:function(e,t,r,n){return Object(R.a)(regeneratorRuntime.mark((function t(){var o,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.metamask,o.ethAccount,o.netId,t.next=3,n["metamask/tronWeb"]();case 3:return c=t.sent,t.next=6,c.contract(I).at(e.address);case 6:return l=t.sent,t.abrupt("return",l);case 8:case"end":return t.stop()}}),t)})))},tokenQueryInstance:function(e,t,r,n){return Object(R.a)(regeneratorRuntime.mark((function e(){var t,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metamask,t.ethAccount,t.netId,e.next=3,n["metamask/tronWeb"]();case 3:return o=e.sent,c=n["metamask/networkConfig"].tokenQueryContract,e.next=7,o.contract(P).at(c);case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})))}}),D={setTokenAddress:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_ADDRESS",t.address)},setAproveTx:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_APPROVE_TX",t.txHash)},setAproveAmount:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_APPROVE_AMOUNT",t.amount)},setAproveTxStatus:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_APPROVE_TX_STATUS",t.status)},setTokenSelectedDisplayInfo:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_SELECTED_DISPLAY_INFO",t.tokenSelectedDisplayInfo)},setTokenSelected:(_=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,o=t.commit,c=t.state,l=r.selected,o("SET_TOKEN_SELECTED",l),o("SET_TOKEN_INFO_LOADED",!0),c.tokenSelected.isETH||(n("getTokenAllowce",{}),n("getTokenBalance",{})),e.prev=5,e.next=8,n("common/getNetIdStorage",{},{root:!0});case 8:(d=e.sent).lastTokenUsed=l,n("common/updateNetIdStorage",{netStorage:d},{root:!0}),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(5);case 15:case"end":return e.stop()}}),e,null,[[5,13]])}))),function(e,t){return _.apply(this,arguments)}),checkLastTokenSelected:(O=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.commit,t.state,o=null,e.prev=2,e.next=5,r("common/getNetIdStorage",{},{root:!0});case 5:c=e.sent,o=c.lastTokenUsed,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:return n("SET_TOKEN_SELECTED",o),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,null,[[2,9]])}))),function(e){return O.apply(this,arguments)}),setTokenBalance:function(e,t){e.dispatch;var r=e.commit,n=(e.state,t.balance);r("SET_TOKEN_BALANCE",n),r("SET_TOKEN_BALANCE_LOADED",!0),console.info("Token Balance",n)},setTokenAllowance:function(e,t){e.dispatch;var r=e.commit,n=(e.state,t.allowance);-1!=n&&(r("SET_TOKEN_ALLOWANCE",n),r("SET_TOKEN_ALLOWANCE_LOADED",!0),console.info("Token Allowance",n))},clearUsedParams:(A=Object(R.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state,t.getters,t.dispatch,r=t.commit,t.rootState,r("CLEAR");case 2:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)}),initBaseParams:(x=Object(R.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.rootState,t.rootGetters,r=t.dispatch,t.commit,t.state,r("checkLastTokenSelected");case 2:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)}),checkAllowceEnough:(S=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,o=t.commit,c=r.finalAmount,l=null!=n.tokenSelected&&n.tokenSelected.isETH||null!=n.tokenSelected&&n.tokenSelected.isTrc10||null!=n.tokenSelected&&null!=n.tokenSelected.decimals&&Object(C.a)(n.allowance).div(Object(C.a)(10).pow(n.tokenSelected.decimals)).gte(Object(C.a)(c)),o("SET_TOKEN_ALLOWANCE_ENOUGH",l),e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return S.apply(this,arguments)}),checkBalanceEnough:(w=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,o=t.commit,c=t.rootState,l=r.finalAmount,d=c.metamask.balance,m=n.tokenSelected,f=!1,null!=m&&(m.isETH?f=Object(C.a)(d).gte(Object(C.a)(l)):null!=m.decimals&&(f=Object(C.a)(n.balance).div(Object(C.a)(10).pow(n.tokenSelected.decimals)).gte(Object(C.a)(l)))),o("SET_TOKEN_BALANCE_ENOUGH",f),e.abrupt("return",f);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return w.apply(this,arguments)}),getTokenAddress:(y=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,r=t.getters,n=t.commit,e.next=3,r.tokenInstance();case 3:o=e.sent,n("SET_TOKEN_ADDRESS",o._address);case 5:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)}),getTokenBalance:(v=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.dispatch,n=t.state,o=t.getters,c=t.rootGetters,l=t.rootState,d=t.commit,!n.address||"0x0000000000000000000000000000000000000000"!=n.address&&"410000000000000000000000000000000000000000"!=n.address){e.next=3;break}return e.abrupt("return",0);case 3:return d("SET_TOKEN_BALANCE_LOADED",!1),m=c["metamask/networkConfig"].rpcCallRetryAttempt,e.abrupt("return",new Promise((function(e,t){var d=function(){var f=Object(R.a)(regeneratorRuntime.mark((function f(k){var T,h,E,v,y,w;return regeneratorRuntime.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(T=k.retryAttempt,h=void 0===T?1:T,h++,f.prev=2,E=l.metamask.ethAccount,v="0x0","number"!=typeof n.address||isNaN(n.address)){f.next=14;break}return f.next=8,c["bulksender/bulksenderInstance"]();case 8:return y=f.sent,f.next=11,y.trc10TokenBalance(n.address,E).call();case 11:v=f.sent,f.next=20;break;case 14:return f.next=16,o.tokenInstance();case 16:return w=f.sent,f.next=19,w.balanceOf(E).call();case 19:v=f.sent;case 20:v.hasOwnProperty("balance")&&(v=v.balance),v=Object(N.hexToNumberString)(v),r("setTokenBalance",{balance:v}),e(v),f.next=29;break;case 26:f.prev=26,f.t0=f.catch(2),h>=m?t(f.t0):d({retryAttempt:h});case 29:case"end":return f.stop()}}),f,null,[[2,26]])})));return function(e){return f.apply(this,arguments)}}();d({})})));case 6:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)}),parseInsertTokenAddress:(E=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,t.state,t.getters,o=t.rootGetters,t.rootState,c=t.commit,l=(l=r.tokenAddress).replace(/^\s+|\s+$/gm,""),e.next=5,o["metamask/tronWeb"]();case 5:d=e.sent,m=!1;try{"number"!=typeof l||isNaN(l)||(m=!0),"string"==typeof l&&"number"==typeof parseInt(l)&&!isNaN(parseInt(l))&&parseInt(l)>1e6&&(m=!0)}catch(e){}if(!d.isAddress(l)&&!m){e.next=15;break}return m&&(l=parseInt(l)),c("SET_TOKEN_ADDRESS",l),e.next=13,n("getTokenInfo");case 13:return f=e.sent,e.abrupt("return",f);case 15:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)}),fetchTokenPrice:(h=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.commit,o=t.dispatch,c=t.rootGetters,l=t.state,n("SET_PRICE_LOADED",!1),(d=c["metamask/networkConfig"]).smartContractPollTime,d.extraFeeOracle,m=d.supportExtraFee,r.metamask.netId,m){e.next=7;break}return n("SET_PRICE_LOADED",!0),e.abrupt("return");case 7:return e.next=9,o("bulksender/setExtraFee",{extraFee:0},{root:!0});case 9:if(n("SET_TOKEN_PRICE",0),"0x0000000000000000000000000000000000000000"!=(f=l.address)&&"410000000000000000000000000000000000000000"!=f){e.next=14;break}return n("SET_PRICE_LOADED",!0),e.abrupt("return");case 14:if(!c["metamask/networkConfig"].specialTokenList.includes(f)){e.next=20;break}return n("SET_TOKEN_PRICE",1),n("SET_PRICE_LOADED",!0),e.abrupt("return");case 20:return e.abrupt("return");case 23:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)}),checkAddressIsContract:(T=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,n=t.getters,o=t.rootGetters,t.rootState,t.commit,c=r.addresses,l=o["metamask/networkConfig"].rpcCallRetryAttempt,e.abrupt("return",new Promise((function(e,t){var r=function(){var o=Object(R.a)(regeneratorRuntime.mark((function o(d){var m,f,k,T;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return m=d.retryAttempt,f=void 0===m?1:m,f++,o.prev=2,o.next=5,n.tokenQueryInstance();case 5:return k=o.sent,o.next=8,k.bulkCheckIfContracts(c).call();case 8:T=o.sent,e(T),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(2),console.info(o.t0),f>=l?t(o.t0):r({retryAttempt:f});case 16:case"end":return o.stop()}}),o,null,[[2,12]])})));return function(e){return o.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return T.apply(this,arguments)}),getTokenInfo:(k=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.state,o=t.getters,c=t.rootGetters,l=t.rootState,t.commit,d=c["metamask/networkConfig"],m=d.rpcCallRetryAttempt,d.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var c=function(){var t=Object(R.a)(regeneratorRuntime.mark((function t(d){var f,k,T,h,E,v,symbol;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f=d.retryAttempt,k=void 0===f?1:f,k++,t.prev=2,T=null,"number"!=typeof n.address||isNaN(n.address)){t.next=11;break}return t.next=7,r("getTrc10TokenInfo");case 7:T=t.sent,console.info(T),t.next=32;break;case 11:return l.metamask.ethAccount,l.bulksender.bulksenderAddress,t.next=15,o.tokenInstance();case 15:return h=t.sent,t.next=18,h.name().call();case 18:return E=t.sent,t.next=21,h.decimals().call();case 21:return v=t.sent,v=Object(N.hexToNumberString)(v),t.next=25,h.symbol().call();case 25:symbol=t.sent,T={contractAddress:n.address,balance:0,name:E,symbol:symbol,decimals:v},r("setTokenSelected",{selected:T}),r("setTokenBalance",{balance:0}),r("setTokenAllowance",{allowance:0});case 32:e(T),t.next=38;break;case 35:t.prev=35,t.t0=t.catch(2),k>=m?e({}):c({retryAttempt:k});case 38:case"end":return t.stop()}}),t,null,[[2,35]])})));return function(e){return t.apply(this,arguments)}}();c({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return k.apply(this,arguments)}),getTrc10TokenInfo:(f=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,n=t.state,t.getters,o=t.rootGetters,t.rootState,t.commit,c=o["metamask/networkConfig"],l=c.rpcCallRetryAttempt,c.tokenQueryContract,(d=o["metamask/networkConfig"]).smartContractPollTime,m=d.trc10TokenInfoOracleUrls,e.abrupt("return",new Promise((function(e,t){var o=function(){var t=Object(R.a)(regeneratorRuntime.mark((function t(c){var d,f,k,T,h,E,v,y,symbol,w,S;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=c.retryAttempt,f=void 0===d?1:d,f++,t.prev=2,k=m[f%m.length],k+=n.address,t.next=7,fetch(k);case 7:if(200!==(T=t.sent).status){t.next=29;break}return t.next=11,T.json();case 11:if(!(h=t.sent).data){t.next=26;break}return E=h.data[0],v=E.name,y=E.precision,y=Object(N.hexToNumberString)(y),symbol=E.abbr,t.next=20,r("getTokenBalance");case 20:w=t.sent,S={contractAddress:n.address,balance:w,name:v,symbol:symbol,decimals:y,isTrc10:!0},r("setTokenSelected",{selected:S}),e(S),t.next=27;break;case 26:throw Error("Fetch trc10 token failed");case 27:t.next=30;break;case 29:throw Error("Fetch trc10 token failed");case 30:t.next=35;break;case 32:t.prev=32,t.t0=t.catch(2),f>=l?e({}):o({retryAttempt:f});case 35:case"end":return t.stop()}}),t,null,[[2,32]])})));return function(e){return t.apply(this,arguments)}}();o({})})));case 4:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)}),bulkQueryBalances:(m=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,n=t.getters,o=t.rootGetters,t.rootState,t.commit,c=r.tokenAddress,l=r.addresses,d=o["metamask/networkConfig"],m=d.rpcCallRetryAttempt,d.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var o=Object(R.a)(regeneratorRuntime.mark((function o(d){var f,k,T,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return f=d.retryAttempt,k=void 0===f?1:f,k++,o.prev=2,o.next=5,n.tokenQueryInstance();case 5:return T=o.sent,o.next=8,T.bulkQueryBalances(c,l).call();case 8:h=o.sent,e(h),o.next=15;break;case 12:o.prev=12,o.t0=o.catch(2),k>=m?t(o.t0):r({retryAttempt:k});case 15:case"end":return o.stop()}}),o,null,[[2,12]])})));return function(e){return o.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)}),checkApproveTransactionStatus:(d=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m,f,k,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,t.getters,n=t.rootGetters,t.rootState,o=t.dispatch,c=t.commit,l=r.approveTx,d=r.approveAmount,m=n["metamask/networkConfig"].smartContractShortPollTime,e.prev=4,e.next=7,n["metamask/tronWebQuery"]();case 7:return f=e.sent,e.next=10,f.trx.getTransaction(l);case 10:k=e.sent,console.info(k),T=0,Array.isArray(k.ret)?(T="SUCCESS"==k.ret[0].contractRet?1:-2,c("SET_TOKEN_APPROVE_TX_STATUS",T),c("SET_TOKEN_ALLOWANCE",d)):setTimeout((function(){o("checkApproveTransactionStatus")}),1e3*m),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),setTimeout((function(){o("checkApproveTransactionStatus")}),1e3*m);case 19:case"end":return e.stop()}}),e,null,[[4,16]])}))),function(e){return d.apply(this,arguments)}),getTokenAllowce:(l=Object(R.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rootState,n=t.getters,o=t.commit,c=t.dispatch,l=t.rootGetters,t.state,o("SET_TOKEN_ALLOWANCE_LOADED",!1),d=l["metamask/networkConfig"],m=d.rpcCallRetryAttempt,d.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var o=function(){var t=Object(R.a)(regeneratorRuntime.mark((function t(l){var d,f,k,T,h,E;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=l.retryAttempt,f=void 0===d?1:d,f++,t.prev=2,k=r.metamask.ethAccount,null!=(T=r.bulksender.bulksenderAddress)&&""!=T||e(-1),t.next=8,n.tokenInstance();case 8:return h=t.sent,t.next=11,h.allowance(k,T).call();case 11:E=t.sent,console.info("allowance",E),E.hasOwnProperty("remaining")&&(E=E.remaining),E=Object(N.hexToNumberString)(E),c("setTokenAllowance",{allowance:E}),e(E),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(2),f>=m?e(0):o({retryAttempt:f});case 22:case"end":return t.stop()}}),t,null,[[2,19]])})));return function(e){return t.apply(this,arguments)}}();o({})})));case 4:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)}),approveForBulksender:(c=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,o=t.rootState,t.rootGetters,c=t.dispatch,t.commit,l=r.amount,l=Object(C.a)(l).times(Object(C.a)(10).pow(parseInt(n.tokenSelected.decimals))).toString(10),d=o.bulksender.bulksenderAddress,e.next=6,c("approve",{bulksenderAddress:d,amount:l});case 6:return m=e.sent,e.abrupt("return",m);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)}),checkApproval:(o=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,o=t.getters,c=t.rootState,t.rootGetters,t.dispatch,l=t.commit,d=r.amount,m=n.checkZeroTimes,d=Object(C.a)(d).times(Object(C.a)(10).pow(parseInt(n.tokenSelected.decimals))).toString(10),f=c.bulksender.bulksenderAddress,e.next=7,o.tokenInstance();case 7:return k=e.sent,c.metamask.ethAccount,T=0,e.abrupt("return",new Promise((function(e,t){var r=function(){var t=Object(R.a)(regeneratorRuntime.mark((function t(n){var o,c,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.retryAttempt,c=void 0===o?0:o,c++,t.prev=2,(h=3==c||4==c)&&(d="0"),k.methods.approve(f,d).encodeABI(),t.next=8,k.methods.approve(f,d).estimateGas();case 8:t.sent,l("SET_NEED_TO_RESET_APPROVAL",h),h&&(T=-1),e({usedApproveZero:h,errorType:T}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),c>=m?e({usedApproveZero:!0,errorType:T=-2}):r({retryAttempt:c});case 17:case"end":return t.stop()}}),t,null,[[2,14]])})));return function(e){return t.apply(this,arguments)}}();r({})})));case 11:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)}),approve:(n=Object(R.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k,T,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,n=t.getters,o=t.rootState,t.rootGetters,c=t.dispatch,l=t.commit,d=r.bulksenderAddress,m=r.amount,f=0,k=null,e.prev=4,o.metamask.gasPrice.fast,e.next=8,n.tokenInstance();case 8:return T=e.sent,o.metamask.ethAccount,e.next=12,T.approve(d,m).send();case 12:return h=e.sent,l("ADD_TX",h),l("SET_TOKEN_APPROVE_TX",h),l("SET_TOKEN_APPROVE_TX_STATUS",0),l("SET_TOKEN_APPROVE_AMOUNT",m),c("checkApproveTransactionStatus"),e.abrupt("return",{txHash:h,errorType:f});case 21:return e.prev=21,e.t0=e.catch(4),e.abrupt("return",{txHash:k,errorType:f});case 24:case"end":return e.stop()}}),e,null,[[4,21]])}))),function(e,t){return n.apply(this,arguments)})};t.default={namespaced:!0,state:function(){return{address:null,balance:0,balanceDisplay:"",allowance:0,allowanceNumber:0,balanceNumber:0,allowanceEnough:!1,balanceEnough:!1,approveAmount:0,approveTx:"",approveTxStatus:-1,tokenSelected:null,tokenSelectedDisplayInfo:"",txs:[],tokenBalanceLoaded:!1,tokenAllowanceLoaded:!1,tokenInfoLoaded:!1,checkZeroTimes:4,needToResetApproval:!1,price:0,priceLoaded:!1}},getters:j,mutations:{SET_TOKEN_ADDRESS:function(e,address){e.address=address},SET_TOKEN_BALANCE:function(e,t){e.balance=t},SET_TOKEN_SELECTED:function(e,t){e.tokenSelected=t},SET_TOKEN_SELECTED_DISPLAY_INFO:function(e,t){e.tokenSelectedDisplayInfo=t},SET_TOKEN_ALLOWANCE:function(e,t){e.allowance=t},SET_TOKEN_ALLOWANCE_ENOUGH:function(e,t){e.allowanceEnough=t},SET_TOKEN_BALANCE_ENOUGH:function(e,t){e.balanceEnough=t},SET_TOKEN_APPROVE_AMOUNT:function(e,t){e.approveAmount=t},SET_TOKEN_APPROVE_TX:function(e,t){e.approveTx=t},SET_TOKEN_APPROVE_TX_STATUS:function(e,t){e.approveTxStatus=t},SET_TOKEN_BALANCE_LOADED:function(e,t){e.tokenBalanceLoaded=t},SET_TOKEN_ALLOWANCE_LOADED:function(e,t){e.tokenAllowanceLoaded=t},SET_TOKEN_INFO_LOADED:function(e,t){e.tokenInfoLoaded=t},SET_NEED_TO_RESET_APPROVAL:function(e,t){e.needToResetApproval=t},SET_TOKEN_PRICE:function(e,t){e.price=t},SET_PRICE_LOADED:function(e,t){e.priceLoaded=t},ADD_TX:function(e,t){e.txs.push(t)},CLEAR:function(e){e.approveTx="",e.approveTxStatus=-1,e.needToResetApproval=!1}},actions:D}},504:function(e,t,r){"use strict";var n,o,c=r(10),l={EN:{header:{vip:"VIP",welcome:"Welcome to ",tutorial:"Tutorial",faq:"FAQ",faucet:"Faucet",dappSupports:"Supports ",step1Title:"Prepare",step2Title:"Confirm",step3Title:"Send",stepApproveTitle:"Approve",oldVersion:"Old Version",mainnet:"TRON Mainnet",ropsten:"Shasta Testnet",ethereum:"Ethereum ERC20",erc20:"ERC20"},footer:{contract:"Contract"},home:{decimalsTitle:"Decimals",parsingTitle:"Checking the possible errors of the address list...",tokenSelectedTitle:"Token",tokenSelectedPlaceholder:"Select or Insert token contract address or token ID",addressesTitle:"Addresses with Balances",addressesUploadDesc:"Drop your files here or ",addressesUploadDescClickUpload:"click to upload",addressesUploadFooterDesc:"Accepted: ",addressesInsertFooterDesc:"Separated by commas",addressesInsertExampleButtonText:"Show examples",manuallyInsert:"Insert manually",uploadInsert:"Upload file",manuallyInsertPlaceholder:"Insert address and amount, separate with comma",approveTitle:"Amount to approve",approveButton:"Approve",approveOption1:"Exact amount to be sent",approveOption2:"Your full token balance",manuallyInsertTokenAddress:"Supports loading token info by manually inserting token address or token id"},info:{prepareStep0:"Checking the possible errors in the address list...",prepareStep1:"Checking the token information...",prepareStep2:"Checking the token balance...",prepareStep3:"Checking the token allowance...",prepareStep4:"Checking the token balance...",prepareStep5:"Constructing the bulksending data...",addressConfirming:"Checking addresses",addressContructing:"Contructing transaction",from:"from",to:"to",copied:"Copied to clipboard"},confirm:{approveHashTitle:"Approve transaction hash",summaryTitle:"Summary",networkSpeedTitle:"Network Speed",networkSpeedSlow:"Slow",networkSpeedStandard:"",networkSpeedFast:"Fast",networkSpeedInstant:"Instant",resetApproval:"Reset allowance transaction hash",sendType:"Options for sending transactions",fastWay:"Use self-generated Key (recommended)",metamask:"Use Metamask (might be slow)",burnKeyTitle:"Your burn key",fastWayTitle:"Fastest recommended way to use bulksender.",fastWayDesc1:"It will generate a burner key on your device",fastWayDesc2:"After the burner key receives the funds, it will automatically post all txs to the blockchain",fastWayDesc3:"Once the bulksend is complete, the burner key will send the remaining ",fastWayDesc4:" balance to your address",metamaskDesc:"We highly recommend using self-generated key option, since your wallet can be slow and does not always function properly.",copyPrivateKeyDes:"Please make a copy of your temporary private key",summary:{totalAddressesTitle:"Total number of addresses",totalAmountTitle:"Total number of tokens to be sent",totalTxsTitle:"Total number of transactions needed",totalTokenBalanceTitle:"Your token balance",totalTokenAllowanceTitle:"Your current bulksender allowance",balanceTitle:" balance",approximateCostTitle:"Approximate cost of operation",energyBalance:"Energy",yourTitle:"Your ",gasPriceTitle:"Gas price",swap1:"Save",swap2:' of the approximate cost with "Energy Swap" by paying ',swap3:"",swap4:" as the energy fee,",swapBtn:"Swap Now",swapErrorInfo1:"Your trx balance should have at least ",swapErrorInfo2:' to complete the "Energy Swap"'}},send:{pleaseSignTransactionsTitle:"Please confirm the transaction on TronLink",sentTransactionsTitle:"Bulksent transactions",sendTransactionsTitle:"You are sending the transaction",checkingTransactionsTitle:"Now wait util all the transactions were mined.",transactionSentoutTitle:"Transactions were sent out. ",congratulationsTransactionsTitle:"Congratulations, your bulksend transactions were sent out successfully",topUpTxTitle:"Top-up process transaction hash",refundRemainingTxTitle:"Refund remaining funds transaction hash",refundingRemainingTxTitle:"Refunding remaining funds to ",hasFailedTransactionsTitle1:"Oops! You have ",hasFailedTransactionsTitle2:"  transactions and failed to send due to execution timeout, copy the failed addresses or resend with one click"},vip:{vipDesc:"Just only pay 30,000 TRX to be a vip member, all your transactions sent through Bulksender.app will be free forever! Keep in mind, you would still need to pay for the mining fees. If you need additional information, feel free to ask in our Telegram channel. ",hasBeenVipDesc:"You have become a VIP member, all your transactions sent through Bulksender.app will be free forever! Keep in mind, you would still need to pay for the mining fees. If you need additional information, feel free to ask in our Telegram channel. ",vipTxHash:"VIP buying transaction hash",vipBuySuccess:"Congratulations, you have been a vip member",sendNow:"Send now",txFreeTitle:"TX FREE",welcomeToJoinVIPTitle:"Welcome to join VIP",descLine0:"You have become a VIP member",descLine1:"Just only pay 30,000 TRX to be a vip member.",descLine2:"All your transactions sent through Bulksender.app will be free forever!",descLine3:"Keep in mind, you would still need to pay for the mining fees.",descLine4:"If you need additional information, feel free to ask in our Telegram channel "},tutorial:{tutorialDesc:"Just only pay 30,000 TRX to be a vip member, all your transactions sent through Bulksender.app will be free forever! Keep in mind, you would still need to pay for the mining fees. If you need additional information, feel free to ask in our Telegram channel. ",tutorialTitle:"Instruction",tutorialVedeoTitle:"Video Demo",step1Title:"Prepare data",step2Title:"Confirm transaction sumary",step3Title:"Send transaction",step0Title1:"Please make sure that you have installed and unlocked",step0Title2:"or visit our dapp in mobile browser of",step0Title3:"",step1:{li1:"Select Tron Mainnet in wallet",li2:"Wait for token list to load",li3:"Select the token that you would like to send from the list, or manually insert your token contract address or token id",li4:"Upload Excel, CSV, Txt addresses with balances or manually insert addresses separated by comma",li5:"Click NEXT"},step2:{li6:"Send Approve transaction",li7:"Confirm bulksending data, include txs, fees",li8:"Click SEND"},step3:{li9:"Confirm transaction in your wallet",li10:"Wait for an airdrop to complete"},done:"Done"},blockMultitabs:{blockTitle:"Detected you are opening multiple tabs",blockDesc:"You have been redirected to this page because there are more than one Bulksender.app page opened. It may cause problems with Browser LocalStorage. Please close this page and go to the previous one."},button:{deleteAllInvalidAddresses:"Delete all invalid",keepFirstOne:"Keep the first one",combineBalances:"Combine balances",next:"NEXT",back:"Back",send:"SEND",checkout:"Chcek out",skip:"Skip",buyVIP:"Buy",signKey:"SIGN KEY",oneClick:"SEND WITH SIGN KEY",gotIt:"Got it",install:"Install",resend:"Resend",copyAddress:"Copy"},warning:{unFinishedTasks:"Found you have unFinished tasks! Please wait a while."},error:{tokenSelectedNull:"Please select your token",addressNull:"Please upload or insert addresses with balances",prepareDataError:"Failed to construct the bulksending data, please try again!",addressInvalid:"Please delete the invalid addresses",addressDuplicated:"Please delete or combine the duplicated addresses",insufficientTokenBalance:"Insufficient token balance",insufficientEtherBalance:"Insufficient trx balance",invalidEthereumAddress:"is a invalid wallet address",cantSupportsContracts:"is a contract address, unsupported receiver address type",invalidEthereumAmount:"wrong amount",invalidEthereumAmountDecimals:"wrong decimal amount",invalidEthereumAddressAndAmount:"is a invalid wallet address and wrong amount",duplicatedEthereumAddresses:"duplicate address",duplicatedEthereumAddressesTitle:"Duplicated wallet addresses",invalidEthereumAddressesTitle:"Invalid wallet addresse or amount",resetApprovalErrorOption1:"Do the batch to spend your left allowance of bulksender",resetApprovalErrorOption2:"Reset the allowance",resetApprovalError:"Detected that your token dont allow to approve when you have remaining allowance, you can do:",approvalError:"Can not approve for your token, please check your token contract source code if it has the approve function",lineOrder:"Line ",line:"",approveError:"Approve error detected",metamaskNotFoundError:"Please install TronLink firstly",metamaskLockedError:"Please unlock your TronLink",accountNotActivedError:"Please firstly active your wallet account",metamaskNotFoundMobileError:"Search the dapp link in the browser of TronLink or imToken",metamaskNotFoundDoubleError:"Please firstly install TronLink and unlock your wallet"}},CN:{header:{vip:"会员",tutorial:"教程",faq:"问题",welcome:"欢迎来到 ",dappSupports:"该Dapp支持",step1Title:"准备",step2Title:"确认",step3Title:"发送",stepApproveTitle:"授信",oldVersion:"旧版本",mainnet:"波场主网",ropsten:"Shasta测试网",faucet:"测试币",ethereum:"以太坊打币",erc20:"ERC20"},footer:{contract:"合约"},home:(n={decimalsTitle:"位数",parsingTitle:"正在检查列表中错误地址...",tokenSelectedTitle:"代币",tokenSelectedPlaceholder:"选择代币/粘贴代币合约地址",addressesTitle:"收款地址和数量",addressesUploadDesc:"将文件拖到此处或",addressesUploadDescClickUpload:"点击上传",addressesUploadFooterDesc:"支持文件类型：",addressesInsertFooterDesc:"每一行应包括地址和数量，逗号分隔",addressesInsertExampleButtonText:"查看例子"},Object(c.a)(n,"tokenSelectedPlaceholder","下拉选择或粘贴TRC20代币地址或TRC10代币ID"),Object(c.a)(n,"manuallyInsert","手动输入"),Object(c.a)(n,"uploadInsert","上传文件"),Object(c.a)(n,"manuallyInsertPlaceholder","请输入地址和数量，以逗号分隔"),Object(c.a)(n,"approveTitle","授信额度"),Object(c.a)(n,"approveButton","去授信"),Object(c.a)(n,"approveOption1","发送数量"),Object(c.a)(n,"approveOption2","代币余额"),Object(c.a)(n,"manuallyInsertTokenAddress","如果未能在列表中找到要发送的代币，请手动插入代币合约地址或代币ID"),n),info:{prepareStep0:"正在检查地址列表...",prepareStep1:"正在检查代币信息...",prepareStep2:"正在检查代币余额...",prepareStep3:"正在检查代币授信...",prepareStep4:"正在检查代币余额...",prepareStep5:"正在组装批量发送数据...",addressConfirming:"确认发送地址",addressContructing:"组装交易批次",from:"从",to:"到",copied:"已复制到剪切板"},vip:{vipDesc:"只需要支付 30,000 TRX @管理员 ",hasBeenVipDesc:"您已经是VIP会员，您在本站的所有交易将永久免费，请放心使用，使用过程中遇到任何问题，请添加微信或直接在电报群中@管理员 ",vipTxHash:"会员购买交易号",vipBuySuccess:"恭喜，您已经成为会员",sendNow:"开始批量发送",txFreeTitle:"终身免费",welcomeToJoinVIPTitle:"欢迎加入VIP",descLine0:"您已经是VIP会员.",descLine1:"只需要支付 30,000 TRX，您将成为VIP会员.",descLine2:"您在本站的所有交易将永久免费.",descLine3:"",descLine4:"如果您想了解更多相关信息，请添加微信或者直接在电报群中@管理员即可 "},tutorial:{tutorialDesc:"Just only pay 30,000 TRX to be a vip member, all your transactions sent through Bulksender.app will be free forever! Keep in mind, you would still need to pay for the mining fees. If you need additional information, feel free to ask in our Telegram channel. ",tutorialTitle:"介绍",tutorialVedeoTitle:"视频教程",step1Title:"准备数据",step2Title:"确认数据",step3Title:"开始发送",step0Title1:"请确保已安装且解锁",step0Title2:"或在",step0Title3:"中打开该Dapp",step1:{li1:"打开钱包，选择Tron主网",li2:"等待代币列表加载完成",li3:"从代币列表中选择要空投的代币，或手动插入您的代币合约地址或代币ID",li4:"上传包含地址，余额的Excel, CSV, Txt文件或者手动插入地址和余额，逗号分隔",li5:"点击下一步"},step2:{li6:"发送授信交易",li7:"确认批量发送数据摘要，包含代币总数、地址总数、费用等",li8:"点击发送"},step3:{li9:"打开钱包确认交易",li10:"等待空投完成"},done:"完成"},blockMultitabs:{blockTitle:"检测到已打开多个网站标签页",blockDesc:"您被自动跳转到此页面是因为您在浏览器的多个标签中打开了Bulksender.app. 它可能会引起浏览器本地存储(LocalStorage)的问题. 请关闭此页面，前往已打开页面继续使用."},confirm:(o={approveHashTitle:"授信交易号",summaryTitle:"摘要",networkSpeedTitle:"交易速度",networkSpeedSlow:"慢",networkSpeedStandard:"",networkSpeedFast:"快",networkSpeedInstant:"极速",resetApproval:"重置授信额度交易号",sendType:"批量发送方式",fastWay:"一键转账 (快速模式)",metamask:"Metamask (可能会慢)",burnKeyTitle:"「加速秘钥」",fastWayTitle:"建议使用该模式，可节省时间，避免错误",fastWayDesc1:"该模式会在您的设备本地创建一把「加速秘钥」",fastWayDesc2:"在「加速秘钥」接收到批量发送所需要的费用后，它将自动将所有交易发送到区块链中",fastWayDesc3:"一旦批量转账完成，「加速秘钥」会将剩余",fastWayDesc4:"发送回您的钱包地址",copyPrivateKeyDes:"请备份该加速秘钥",metamaskDesc:"我们强烈建议使用「一键转账」, 不然您的钱包可能会变的很慢，而且Metamask操作经常卡顿"},Object(c.a)(o,"copyPrivateKeyDes","请备份「加速秘钥」账户私钥"),Object(c.a)(o,"summary",{totalAddressesTitle:"地址总数",totalAmountTitle:"代币发送总数",totalTxsTitle:"交易总数",totalTokenBalanceTitle:"代币余额",totalTokenAllowanceTitle:"当前授信额度",balanceTitle:"余额",approximateCostTitle:"预估费用",energyBalance:"可用能量",yourTitle:"你的",gasPriceTitle:"交易速度",swap1:'通过 "能量兑换" 功能, 可以节省',swap2:"",swap3:", 仅需要支付",swap4:"作为能量费用, ",swapBtn:"兑换能量",swapErrorInfo1:"你的TRX钱包至少需要有 ",swapErrorInfo2:', 以完成"兑换操作."'}),o),send:{pleaseSignTransactionsTitle:"请打开TronLink钱包授权交易",sentTransactionsTitle:"已发送交易",sendTransactionsTitle:"正在发送交易",checkingTransactionsTitle:"请等待交易被确认。",transactionSentoutTitle:"交易已全部发出，",congratulationsTransactionsTitle:"祝贺，批量交易发送成功！",topUpTxTitle:"转移费用至「加速秘钥」交易号",refundRemainingTxTitle:"剩余费用退回交易号",refundingRemainingTxTitle:"正在将剩余费用退回至",hasFailedTransactionsTitle1:"抱歉，您有 ",hasFailedTransactionsTitle2:" 比交易，因为交易执行超时，未能成功发送，你可以点击复制失败地址或一键重新发送"},button:{deleteAllInvalidAddresses:"删除无效地址",keepFirstOne:"保留第一个",combineBalances:"合并重复项",next:"下一步",back:"<- 上一步",send:"发送",checkout:"查看",skip:"跳过",buyVIP:"购买",signKey:"签名",oneClick:"一键转账",gotIt:"知道了",install:"安装",resend:"重新发送",copyAddress:"复制地址"},warning:{unFinishedTasks:"发现您有未完成的批量发送！请耐心等待!"},error:{tokenSelectedNull:"请选择代币",addressNull:"请上传或插入地址",prepareDataError:"数据组装出错，请重试!",addressInvalid:"请处理无效的地址或数量",addressDuplicated:"请删除或合并重复地址",insufficientTokenBalance:"代币余额不足",insufficientEtherBalance:"TRX余额不足",invalidEthereumAddress:"无效的钱包地址",cantSupportsContracts:"为合约地址，不支持发送",invalidEthereumAmount:"无效的发送数量",invalidEthereumAmountDecimals:"发送数量中的小数点位数错误",invalidEthereumAddressAndAmount:"无效的钱包地址和发送数量",duplicatedEthereumAddresses:"地址重复",duplicatedEthereumAddressesTitle:"发现有重复钱包地址",invalidEthereumAddressesTitle:"钱包地址或发送数量不合法",resetApprovalErrorOption1:"发送批量交易，将剩余授信额度消耗完",resetApprovalErrorOption2:"重置授信额度",resetApprovalError:"检测到您的代币不允许在有剩余授信额度的情况下，重复进行授信，您有2个选项:",approvalError:"授信失败，请检查您的代币合约代码，是否包含授信功能",lineOrder:"第",line:"行",approveError:"检测到授信错误",metamaskNotFoundError:"请先安装TronLink钱包",metamaskNotFoundMobileError:"请在imToken或TronLink浏览器中搜索该链接",metamaskLockedError:"请打开TronLink解锁账户",accountNotActivedError:"请激活账户后，继续使用Bulksender",metamaskNotFoundDoubleError:"请先安装TronLink钱包并解锁账户"}}};t.a=l},862:function(e,t,r){"use strict";r.r(t);r(376),r(139),r(140),r(63),r(62);var n,o,c,l,d,m,f,k,T=r(1),h=r(25),E=r(5),v=r(505),y={energySwapInstance:function(e,t,r,n){return Object(T.a)(regeneratorRuntime.mark((function e(){var t,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metamask,t.ethAccount,t.netId,e.next=3,n["metamask/tronWebQuery"]();case 3:return o=e.sent,c=n["metamask/networkConfig"].energySwapContract,e.next=7,o.contract(v).at(c);case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})))},availableEnergy:function(e){var t=0;try{t=Object(E.a)(e.availableEnergy).times(Object(E.a)(e.maxRate)).div(Object(E.a)(100)).div(Object(E.a)(1e6)).toFixed(0)}catch(e){}return t},swapFee:function(e){var t=0;try{t=Object(E.a)(e.energyTRX).div(Object(E.a)(1e6)).toString(10)}catch(e){}return t},swapFeeWithGas:function(e,t,r,n){var o=0,c=r.metamask.energyFee;try{var l=Object(E.a)(e.buyEnergyGasFee).times(Object(E.a)(c));o=Object(E.a)(e.energyTRX).plus(l).div(Object(E.a)(1e6)).toString(10)}catch(e){}return o},gasFee:function(e,t,r,n){var o=r.metamask.energyFee,c=0;try{c=Object(E.a)(e.buyEnergyGasFee).times(Object(E.a)(o)).div(Object(E.a)(1e6)).toString(10)}catch(e){}return c}},w={setTokenAddress:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_ADDRESS",t.address)},prepareEnergySwapData:(k=Object(T.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m,f,k,T,h,v,y,w,S,x,A,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.rootGetters,o=t.dispatch,c=t.commit,l=t.state,!n["metamask/networkConfig"].energySwapEnable){e.next=43;break}return e.prev=3,e.next=6,o("checkAvailableEnergy");case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(3);case 10:return c("SET_ESTIMATED_DONE",!1),d=r.metamask,m=d.energyFee,f=d.energyBalance,k=r.common.addressInfo,e.next=15,n["energyswap/availableEnergy"];case 15:if(T=e.sent,h=Object(E.a)(k.totalGas),v=Object(E.a)(T),!Object(E.a)(f).lt(h)){e.next=41;break}if((y=h.minus(Object(E.a)(f))).gt(v)&&(y=v),!y.gte(Object(E.a)(l.minOrder))){e.next=39;break}return e.next=24,o("calculateTRXByEnergy",{totalEnergy:y.toString(10),uintType:l.uintType,rentalPeriod:l.rentalPeriod});case 24:w=e.sent,w=Object(E.a)(w).times(Object(E.a)(100+parseInt(l.serviceFee))).div(Object(E.a)(100)),S=y.times(Object(E.a)(100-l.distance)).div(Object(E.a)(100)),x=S.times(Object(E.a)(m)),A=y.times(Object(E.a)(m)),O=Object(E.a)(l.buyEnergyGasFee).times(Object(E.a)(m)),w.plus(O),x=x.div(Object(E.a)(1e6)).toString(10),A=A.div(Object(E.a)(1e6)).toString(10),c("SET_MIN_SAVED_TRX",x),c("SET_MAX_SAVED_TRX",A),c("SET_ENERGY_TRX",w),c("SET_BUY_ENERGY",y.toString(10)),c("SET_ENERGY_ENOUGH",!1),c("SET_ESTIMATED_DONE",!0);case 39:e.next=43;break;case 41:c("SET_ENERGY_ENOUGH",!0),c("SET_ESTIMATED_DONE",!0);case 43:case"end":return e.stop()}}),e,null,[[3,8]])}))),function(e){return k.apply(this,arguments)}),checkAvailableEnergy:(f=Object(T.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,t.getters,r=t.rootGetters,t.rootState,n=t.commit,o=r["metamask/networkConfig"],c=o.rpcCallRetryAttempt,o.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var o=function(){var l=Object(T.a)(regeneratorRuntime.mark((function l(d){var m,f,k,T,E,v,y,w,S;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return m=d.retryAttempt,f=void 0===m?1:m,f++,l.prev=2,k="availableEnergyOfMarket()",T={},l.next=7,r["metamask/tronWebQuery"]();case 7:return E=l.sent,v=r["metamask/networkConfig"].energySwapContract,l.next=11,E.transactionBuilder.triggerConstantContract(v,k,T,[]);case 11:y=l.sent,(w=y.constant_result[0]).startsWith("0x")||(w="0x"+w),S=Object(h.hexToNumberString)(w),n("SET_AVALIABLE_ENERGY",S),e(S),l.next=22;break;case 19:l.prev=19,l.t0=l.catch(2),f>=c?t(l.t0):o({retryAttempt:f});case 22:case"end":return l.stop()}}),l,null,[[2,19]])})));return function(e){return l.apply(this,arguments)}}();o({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)}),checkMaxRate:(m=Object(T.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,t.getters,r=t.rootGetters,t.rootState,n=t.commit,o=r["metamask/networkConfig"],c=o.rpcCallRetryAttempt,o.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var o=function(){var l=Object(T.a)(regeneratorRuntime.mark((function l(d){var m,f,k,T,E,v,y,w,S;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return m=d.retryAttempt,f=void 0===m?1:m,f++,l.prev=2,k="maxEnergyRate()",T={},l.next=7,r["metamask/tronWebQuery"]();case 7:return E=l.sent,v=r["metamask/networkConfig"].energySwapContract,l.next=11,E.transactionBuilder.triggerConstantContract(v,k,T,[]);case 11:y=l.sent,(w=y.constant_result[0]).startsWith("0x")||(w="0x"+w),S=Object(h.hexToNumberString)(w),n("SET_MAX_RATE",S),e(S),l.next=23;break;case 19:l.prev=19,l.t0=l.catch(2),console.info(l.t0),f>=c?t(l.t0):o({retryAttempt:f});case 23:case"end":return l.stop()}}),l,null,[[2,19]])})));return function(e){return l.apply(this,arguments)}}();o({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)}),checkServiceFee:(d=Object(T.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,t.getters,r=t.rootGetters,t.rootState,n=t.commit,o=r["metamask/networkConfig"],c=o.rpcCallRetryAttempt,o.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var o=function(){var l=Object(T.a)(regeneratorRuntime.mark((function l(d){var m,f,k,T,E,v,y,w,S;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return m=d.retryAttempt,f=void 0===m?1:m,f++,l.prev=2,k="txFee()",T={},l.next=7,r["metamask/tronWebQuery"]();case 7:return E=l.sent,v=r["metamask/networkConfig"].energySwapContract,l.next=11,E.transactionBuilder.triggerConstantContract(v,k,T,[]);case 11:y=l.sent,(w=y.constant_result[0]).startsWith("0x")||(w="0x"+w),S=Object(h.hexToNumberString)(w),n("SET_SERVICE_FEE",S),e(S),l.next=23;break;case 19:l.prev=19,l.t0=l.catch(2),console.info(l.t0),f>=c?t(l.t0):o({retryAttempt:f});case 23:case"end":return l.stop()}}),l,null,[[2,19]])})));return function(e){return l.apply(this,arguments)}}();o({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),calculateTRXByEnergy:(l=Object(T.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.state,t.getters,n=t.rootGetters,t.rootState,t.commit,o=r.totalEnergy,c=r.uintType,l=void 0===c?1:c,d=r.rentalPeriod,m=void 0===d?1:d,f=n["metamask/networkConfig"],k=f.rpcCallRetryAttempt,f.tokenQueryContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var c=Object(T.a)(regeneratorRuntime.mark((function c(d){var f,T,E,v,y,w,S,x,A,O;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return f=d.retryAttempt,T=void 0===f?1:f,T++,c.prev=2,E="calculateTRXByEnergy(uint256,uint8,uint256)",v={},y=[{type:"uint256",value:o},{type:"uint8",value:l},{type:"uint256",value:m}],c.next=8,n["metamask/tronWebQuery"]();case 8:return w=c.sent,S=n["metamask/networkConfig"].energySwapContract,c.next=12,w.transactionBuilder.triggerConstantContract(S,E,v,y);case 12:x=c.sent,(A=x.constant_result[0]).startsWith("0x")||(A="0x"+A),O=Object(h.hexToNumberString)(A),console.info(O),e(O),c.next=23;break;case 20:c.prev=20,c.t0=c.catch(2),T>=k?t(c.t0):r({retryAttempt:T});case 23:case"end":return c.stop()}}),c,null,[[2,20]])})));return function(e){return c.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)}),buyEnergy:(c=Object(T.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m,f,k,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,t.getters,n=t.rootState,t.rootGetters,o=t.dispatch,t.commit,c=r.buyEnergy,l=r.uintType,d=r.rentalPeriod,m=r.distance,f=r.energyTRX,k=n.metamask.balance,Object(E.a)(k).times(Object(E.a)(1e6)).gte(Object(E.a)(f))){e.next=10;break}return e.abrupt("return",{txHash:null,errorType:-1});case 10:return T=o("_buyEnergy",{amount:c,uintType:l,rentalPeriod:d,distance:m,trx:f}),e.abrupt("return",T);case 12:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),_buyEnergy:(o=Object(T.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k,h,E,v,y,w,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,n=t.rootState,o=t.rootGetters,c=t.dispatch,l=t.commit,d=r.amount,m=r.uintType,f=void 0===m?1:m,k=r.rentalPeriod,h=void 0===k?1:k,E=r.distance,v=void 0===E?10:E,y=r.trx,w=o["metamask/networkConfig"],S=w.rpcCallRetryAttempt,w.energySwapContract,e.abrupt("return",new Promise((function(e,t){var r=function(){var t=Object(T.a)(regeneratorRuntime.mark((function t(m){var k,T,E,w,x,A,O,_,R,N;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k=m.retryAttempt,T=void 0===k?1:k,T++,t.prev=2,E=n.metamask.ethAccount,w=[{type:"address",value:E},{type:"uint256",value:d},{type:"uint8",value:f},{type:"uint256",value:h},{type:"uint256",value:v}],x=o["metamask/networkConfig"].energySwapContract,A={callValue:y,feeLimit:2e8},t.next=10,tronWeb.transactionBuilder.triggerSmartContract(x,"buyEnergy(address,uint256,uint8,uint256,uint256)",A,w);case 10:return O=t.sent,t.next=13,tronWeb.trx.sign(O.transaction);case 13:return _=t.sent,t.next=16,tronWeb.trx.sendRawTransaction(_);case 16:R=t.sent,N=R.txid,l("SET_ENERGYSWAP_TX",N),l("SET_ENERGYSWAP_TX_STATUS",0),c("checkTransactionStatus",{txHash:N}),e({txHash:N,errorType:0}),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(2),T>=S||402==t.t0.code||"Confirmation declined by user"==t.t0?e({txHash:null,errorType:0}):r({retryAttempt:T});case 27:case"end":return t.stop()}}),t,null,[[2,24]])})));return function(e){return t.apply(this,arguments)}}();r({})})));case 6:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)}),checkTransactionStatus:(n=Object(T.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,n=t.rootGetters,t.rootState,o=t.dispatch,c=t.commit,l=r.txHash,d=n["metamask/networkConfig"].smartContractShortPollTime,e.prev=3,m={},e.prev=5,e.next=8,n["metamask/tronWebQuery"]();case 8:return f=e.sent,e.next=11,f.trx.getTransaction(l);case 11:m=e.sent,e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(5),e.next=18,tronWeb.trx.getTransaction(l);case 18:m=e.sent;case 19:console.info(m),k=0,Array.isArray(m.ret)?(k="SUCCESS"==m.ret[0].contractRet?1:-2,c("SET_ENERGYSWAP_TX_STATUS",k)):setTimeout((function(){o("checkTransactionStatus",{txHash:l})}),1e3*d),e.next=28;break;case 24:e.prev=24,e.t1=e.catch(3),console.info("checking error",e.t1),o("checkTransactionStatus",{txHash:l});case 28:case"end":return e.stop()}}),e,null,[[3,24],[5,14]])}))),function(e,t){return n.apply(this,arguments)})};t.default={namespaced:!0,state:function(){return{availableEnergy:0,maxRate:90,serviceFee:100,distance:10,buyEnergy:1e5,minSavedTRX:0,maxSavedTRX:0,estimatedDone:!1,uintType:1,rentalPeriod:1,energyEnough:!1,buyEnergyGasFee:7e4,energyTRX:0,minOrder:1e5,energyswapTx:"",energyswapTxStatus:-1}},getters:y,mutations:{SET_AVALIABLE_ENERGY:function(e,t){e.availableEnergy=t},SET_MAX_RATE:function(e,t){e.maxRate=t},SET_SERVICE_FEE:function(e,t){e.serviceFee=t},SET_BUY_ENERGY:function(e,t){e.buyEnergy=t},SET_MIN_SAVED_TRX:function(e,t){e.minSavedTRX=t},SET_MAX_SAVED_TRX:function(e,t){e.maxSavedTRX=t},SET_ESTIMATED_DONE:function(e,t){e.estimatedDone=t},SET_ENERGY_ENOUGH:function(e,t){e.energyEnough=t},SET_ENERGY_TRX:function(e,t){e.energyTRX=t},SET_ENERGYSWAP_TX:function(e,t){e.energyswapTx=t},SET_ENERGYSWAP_TX_STATUS:function(e,t){e.energyswapTxStatus=t}},actions:w}},863:function(e,t,r){"use strict";r.r(t);r(123),r(107),r(83),r(98),r(326);var n=r(10),o=(r(138),r(139),r(140),r(63),r(224),r(295),r(864),r(62),r(1)),c=(r(865),r(25)),l=r(158),d=r(5),m=r(344),f=r(345),k=r.n(f);function T(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?T(source,!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):T(source).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var E,v,y,w,S,x,A,O,_,R=function(e){e.newAccount;(0,e.commit)("IDENTIFY",account)},N={netId:function(e){return e.netId},isApiValible:function(e){return 1==e.netId},networkName:function(e){return l.a["netId".concat(e.netId)].networkName},currency:function(e){return l.a["netId".concat(e.netId)].currencyName},networkConfig:function(e){return l.a["netId".concat(e.netId)]},getTronProvider:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.providerName,e.networkName,t.t0=r,t.next=(t.t0,4);break;case 4:return t.prev=4,t.abrupt("return",window.tronLink.tronWeb);case 8:return t.prev=8,t.t1=t.catch(4),t.abrupt("return",window.tronWeb);case 11:case"end":return t.stop()}}),t,null,[[4,8]])})))},tronWeb:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTronProvider();case 2:return(r=e.sent).setHeader({"TRON-PRO-API-KEY":"c3e29ffa-e309-4e20-8942-58957c129dfd"}),e.abrupt("return",Object.freeze(r));case 5:case"end":return e.stop()}}),e)})))},tronWebQuery:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,l,d,m=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=m.length>0&&void 0!==m[0]?m[0]:"01",n="https://api.tronstack.io",o="https://api.tronstack.io",c="https://api.tronstack.io",2==e.netId&&(n="https://api.shasta.trongrid.io",o="https://api.shasta.trongrid.io",c="https://api.shasta.trongrid.io"),window.tronWebSelfForBulksender?l=window.tronWebSelfForBulksender:(k.a.providers.HttpProvider,d=new k.a(n,o,c,r),1==e.netId&&n.includes("trongrid")&&d.setHeader({"TRON-PRO-API-KEY":"c3e29ffa-e309-4e20-8942-58957c129dfd"}),window.tronWebSelfForBulksender=d,l=d),t.abrupt("return",l);case 7:case"end":return t.stop()}}),t)})))}},C={IDENTIFY:function(e,t){e.ethAccount=t},SET_NET_ID:function(e,t){t=parseInt(t,10),e.netId=t},SET_BALANCE:function(e,t){e.balance=tronWeb.fromSun(t)},SET_ENERGY_BALANCE:function(e,t){e.energyBalance=t},SET_WALLET_STATE:function(e,t){e.walletState=t},SET_CHECKING_TIMES:function(e,t){e.checkingTimes=t},SET_ADDRESS:function(e,t){var address=t.address,r=t.valid,n=void 0!==r&&r;e.address={value:address,valid:n}},SAVE_GAS_PRICE:function(e,t){e.gasPrice=t},SAVE_TOKENS:function(e,t){e.tokens=t},SET_TOKEN_ADDRESS:function(e,t){e.tokenAddress=t},SET_FETCHING:function(e,t){e.isFetching=t},SET_PROVIDER_NAME:function(e,t){e.providerName=t},SET_NETWORK_NAME:function(e,t){e.networkName=t},SAVE_TRC10_TOKENS:function(e,t){e.trc10Tokens=t},SAVE_ETH_PRICE:function(e,t){e.ethPrice=t},SET_ETH_PRICE_LOADED:function(e,t){e.ethPriceLoaded=t},SAVE_MAX_CPU_TIME_ONE_TX:function(e,t){e.maxCpuTimeOfOneTx=t},SAVE_ENERGY_FEE:function(e,t){e.energyFee=t},SAVE_BANDWIDTH_FEE:function(e,t){e.bandwidthFee=t}},I={setAddress:function(e,t){e.dispatch;(0,e.commit)("SET_ADDRESS",{address:t.address,valid:!0})},setTokenAddress:function(e,t){e.dispatch;(0,e.commit)("SET_TOKEN_ADDRESS",t.address)},onNetworkChanged:function(e,t){(0,e.commit)("SET_NET_ID",t.netId)},updateEnergyBalance:function(e,t){(0,e.commit)("SET_ENERGY_BALANCE",t.energy)},getBalance:function(e){var t=e.dispatch,r=(e.commit,e.state),n=e.getters,c=e.rootGetters,l=n.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,n){var d=function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(o){var m,f,k,T,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return m=o.retryAttempt,f=void 0===m?1:m,f++,n.prev=2,n.next=5,c["metamask/tronWebQuery"]();case 5:return k=n.sent,n.next=8,k.trx.getBalance(r.ethAccount);case 8:(T=n.sent).hasOwnProperty("remaining")&&(T=T.remaining),T.hasOwnProperty("balance")&&(T=T.balance),e(T),n.next=24;break;case 14:if(n.prev=14,n.t0=n.catch(2),!(f>=l)){n.next=23;break}return n.next=19,t("getBalanceByAPI");case 19:h=n.sent,e(h),n.next=24;break;case 23:d({retryAttempt:f});case 24:case"end":return n.stop()}}),n,null,[[2,14]])})));return function(e){return n.apply(this,arguments)}}();d({})}))},getBalanceByAPI:function(e){e.dispatch,e.commit;var t=e.state,r=e.getters.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,n){var c=function(){var l=Object(o.a)(regeneratorRuntime.mark((function o(l){var d,m,f,k,T,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return d=l.retryAttempt,m=void 0===d?1:d,m++,o.prev=2,f="https://apilist.tronscan.org/api/account?address="+t.ethAccount,o.next=6,fetch(f);case 6:if(k=o.sent,T="0",200!=k.status){o.next=17;break}return o.next=11,k.json();case 11:h=o.sent,T=h.balance,console.info("balance",T),e(T),o.next=18;break;case 17:throw Error("Fetch tokens failed");case 18:e(T),o.next=24;break;case 21:o.prev=21,o.t0=o.catch(2),m>=r?n(o.t0):c({retryAttempt:m});case 24:case"end":return o.stop()}}),o,null,[[2,21]])})));return function(e){return l.apply(this,arguments)}}();c({})}))},updateAccountBalance:function(e){var t=e.dispatch,r=e.state,n=e.commit,c=e.getters,l=e.rootGetters,d=c.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,c){var m=function(){var f=Object(o.a)(regeneratorRuntime.mark((function o(f){var k,T,h,E;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return k=f.retryAttempt,T=void 0===k?1:k,T++,o.prev=2,o.next=5,l["metamask/tronWebQuery"]();case 5:return h=o.sent,o.next=8,h.trx.getBalance(r.ethAccount);case 8:return(E=o.sent).hasOwnProperty("remaining")&&(E=E.remaining),E.hasOwnProperty("balance")&&(E=E.balance),n("SET_BALANCE",E),o.next=14,t("getAccountResources");case 14:e(E),o.next=21;break;case 17:o.prev=17,o.t0=o.catch(2),console.info(o.t0),T>=d?c(o.t0):m({retryAttempt:T});case 21:case"end":return o.stop()}}),o,null,[[2,17]])})));return function(e){return f.apply(this,arguments)}}();m({})}))},getAccount:function(e){e.dispatch;var t=e.state,r=e.getters,n=e.rootGetters,c=r.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,r){var l=function(){var d=Object(o.a)(regeneratorRuntime.mark((function o(d){var m,f,k,T,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return m=d.retryAttempt,f=void 0===m?1:m,f++,o.prev=2,o.next=5,n["metamask/tronWebQuery"]();case 5:return k=o.sent,T=t.ethAccount,t.ethAccount||(T=tronWeb.defaultAddress.base58),o.next=10,k.trx.getAccount(T);case 10:h=o.sent,e(h),o.next=17;break;case 14:o.prev=14,o.t0=o.catch(2),f>=c?r(o.t0):l({retryAttempt:f});case 17:case"end":return o.stop()}}),o,null,[[2,14]])})));return function(e){return d.apply(this,arguments)}}();l({})}))},getAccountResources:function(e){e.dispatch;var t=e.state,r=e.getters,n=e.commit,c=e.rootGetters,l=r.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,r){var m=function(){var f=Object(o.a)(regeneratorRuntime.mark((function o(f){var k,T,h,E,v,y;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(k=f.retryAttempt,T=void 0===k?1:k,T++,o.prev=2,!t.ethAccount){o.next=14;break}return o.next=6,c["metamask/tronWebQuery"]();case 6:return h=o.sent,o.next=9,h.trx.getAccountResources(t.ethAccount);case 9:(E=o.sent).EnergyLimit?(v=0,E.EnergyUsed&&(v=E.EnergyUsed),y=Object(d.a)(E.EnergyLimit).minus(Object(d.a)(v)).toNumber(),n("SET_ENERGY_BALANCE",y)):n("SET_ENERGY_BALANCE",0),e(E),o.next=15;break;case 14:e({});case 15:o.next=20;break;case 17:o.prev=17,o.t0=o.catch(2),T>=l?r(o.t0):m({retryAttempt:T});case 20:case"end":return o.stop()}}),o,null,[[2,17]])})));return function(e){return f.apply(this,arguments)}}();m({})}))},getChainParams:function(e){e.dispatch,e.state;var t=e.getters,r=e.commit,n=e.rootGetters,c=t.networkConfig.rpcCallRetryAttempt;return new Promise((function(e,t){var l=function(){var d=Object(o.a)(regeneratorRuntime.mark((function o(d){var m,f,k,T,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return m=d.retryAttempt,f=void 0===m?1:m,f++,o.prev=2,o.next=5,n["metamask/tronWebQuery"]();case 5:return k=o.sent,o.next=8,k.trx.getChainParameters();case 8:T=o.sent,h={},T.forEach((function(e,i){h[e.key]=e.value})),r("SAVE_MAX_CPU_TIME_ONE_TX",parseInt(h.getMaxCpuTimeOfOneTx*Math.pow(10,4)*1)),r("SAVE_ENERGY_FEE",h.getEnergyFee),r("SAVE_BANDWIDTH_FEE",h.getTransactionFee),e(T),o.next=20;break;case 17:o.prev=17,o.t0=o.catch(2),f>=c?t(o.t0):l({retryAttempt:f});case 20:case"end":return o.stop()}}),o,null,[[2,17]])})));return function(e){return d.apply(this,arguments)}}();l({})}))},detectTronWeb:(_=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.commit,t.dispatch,r=t.getters,t.state,n=80,o=function(time){return new Promise((function(e){return setTimeout(e,time)}))},e.prev=3,c=!1,l=!1,d=0;case 7:if(!(d<n)){e.next=36;break}return e.next=10,r.getTronProvider();case 10:if(null!=(m=e.sent)){e.next=16;break}return e.next=14,o(100);case 14:e.next=33;break;case 16:if(c=!0,!m.ready){e.next=22;break}return l=!0,e.abrupt("break",36);case 22:return e.prev=22,e.next=25,tronLink.request({method:"tron_requestAccounts"});case 25:e.sent,e.next=31;break;case 28:e.prev=28,e.t0=e.catch(22),console.info(e.t0);case 31:return e.next=33,o(100);case 33:d++,e.next=7;break;case 36:return console.info("TronWeb inited",c),console.info("TronLink unlocked",l),e.abrupt("return",{hasTronWeb:c,tronUnlocked:l,injectedTronWeb:tronWeb});case 41:return e.prev=41,e.t1=e.catch(3),e.abrupt("return",{hasTronWeb:!1,tronUnlocked:!1,injectedTronWeb:void 0});case 44:case"end":return e.stop()}}),e,null,[[3,41],[22,28]])}))),function(e){return _.apply(this,arguments)}),askPermission:function(e,t){var r=e.commit,n=e.dispatch,l=e.getters,d=e.state,m=t.providerName,f=t.networkName;r("SET_PROVIDER_NAME",m),r("SET_NETWORK_NAME",f);var k=l.networkConfig,T=(k.smartContractPollTime,k.rpcCallRetryAttempt),h=k.energySwapEnable;try{window.tronWebSelfForBulksender=void 0}catch(e){}var E={},v=function(time){return new Promise((function(e){return setTimeout(e,time)}))};return new Promise((function(e,t){var l=function(){var m=Object(o.a)(regeneratorRuntime.mark((function o(m){var f,k,y,w,S,x,A,O,_,N,C,I,P;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return f=m.retryAttempt,k=void 0===f?0:f,o.prev=1,o.next=4,n("detectTronWeb");case 4:y=o.sent,w=y.hasTronWeb,S=y.tronUnlocked,x=y.injectedTronWeb,w?S?r("SET_WALLET_STATE",1):(r("SET_WALLET_STATE",-2),t(new Error("locked TronLink or TronPay"))):(r("SET_WALLET_STATE",-1),t(new Error("Please Install TronLink or TronPay")));try{window.addEventListener("message",(function(e){e.data.message&&"setAccount"==e.data.message.action&&(null!=x?e.data.message.data.address!=d.ethAccount&&window.location.reload():window.location.reload()),e.data.message&&"setNode"==e.data.message.action&&window.location.reload()}))}catch(e){}if(!w||!S){o.next=66;break}if(A=1,O=void 0,E.accountFetchedDone){o.next=33;break}return o.next=16,v(1e3);case 16:return o.next=18,n("getAccount");case 18:_=o.sent,O=tronWeb.address.fromHex(_.address),r("IDENTIFY",O),n("setAddress",{address:O}),N=_.balance,console.info("balance",N,"account",O),N=Object(c.hexToNumberString)(N),n("saveUserBalance",{balance:N}),C=tronWeb.fullNode.host,I=tronWeb.solidityNode.host,P=tronWeb.eventServer.host,(C.indexOf("shasta")>-1||I.indexOf("shasta")>-1||P.indexOf("shasta")>-1)&&(A=2),n("onNetworkChanged",{netId:A}),tronWeb.on&&tronWeb.on("addressChanged",(function(e){return R({dispatch:n,commit:r,newAccount:e})})),E.accountFetchedDone=!0;case 33:return o.prev=33,o.next=36,n("getAccountResources");case 36:o.next=40;break;case 38:o.prev=38,o.t0=o.catch(33);case 40:return o.next=42,n("fetchTokenList",{});case 42:return o.next=44,n("getChainParams");case 44:if(E.bulksenderFetchedDone){o.next=50;break}return o.next=47,v(1e3);case 47:return o.next=49,n("bulksender/initBaseParams",{},{root:!0});case 49:E.bulksenderFetchedDone=!0;case 50:if(n("common/initBaseParams",{},{root:!0}),E.tokenFetchedDone){o.next=57;break}return o.next=54,v(1e3);case 54:return o.next=56,n("token/initBaseParams",{},{root:!0});case 56:E.tokenFetchedDone=!0;case 57:if(E.tokenBalanceFetchedDone){o.next=63;break}return o.next=60,v(1e3);case 60:return o.next=62,n("token/getTokenBalance",{},{root:!0});case 62:E.tokenBalanceFetchedDone=!0;case 63:try{n("fetchCoinPrice")}catch(e){}try{h&&(n("energyswap/checkAvailableEnergy",{},{root:!0}),n("energyswap/checkMaxRate",{},{root:!0}),n("energyswap/checkServiceFee",{},{root:!0}))}catch(e){}e({netId:A,ethAccount:O});case 66:o.next=73;break;case 68:o.prev=68,o.t1=o.catch(1),k++,console.info("except:",o.t1),k>=T?t(o.t1):l({retryAttempt:k});case 73:case"end":return o.stop()}}),o,null,[[1,68],[33,38]])})));return function(e){return m.apply(this,arguments)}}();l({})}))},saveUserBalance:function(e,t){(0,e.commit)("SET_BALANCE",t.balance)},fetchCoinPrice:(O=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,c,l,d,f,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.commit,c=t.dispatch,l=t.rootGetters,t.state,(d=l["metamask/networkConfig"]).smartContractPollTime,f=d.extraFeeOracle,k=d.supportExtraFee,r.metamask.netId,k){e.next=6;break}return n("SET_ETH_PRICE_LOADED",!0),e.abrupt("return");case 6:return e.abrupt("return",new Promise((function(e,t){var r=function(){var l=Object(o.a)(regeneratorRuntime.mark((function o(l){var d,k,T,h,E,v,y;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return d=l.retryAttempt,k=void 0===d?1:d,k++,o.prev=2,o.next=5,Object(m.a)(f.coinPriceUrl,{timeout:7e3});case 5:if(200!==(T=o.sent).status){o.next=17;break}return o.next=9,T.json();case 9:h=o.sent,E=0,h.hasOwnProperty(f.coinId)&&(E=h[f.coinId].usd),n("SAVE_ETH_PRICE",E),n("SET_ETH_PRICE_LOADED",!0),e(E),o.next=18;break;case 17:throw Error("Fetch coin price failed");case 18:o.next=35;break;case 20:if(o.prev=20,o.t0=o.catch(2),!(k>=2)){o.next=34;break}if(!(v=f.coinBackups)||!v.length){o.next=31;break}return o.next=27,c("fetchCoinPriceFromBackups");case 27:y=o.sent,e(y),o.next=32;break;case 31:t(o.t0);case 32:o.next=35;break;case 34:r({retryAttempt:k});case 35:case"end":return o.stop()}}),o,null,[[2,20]])})));return function(e){return l.apply(this,arguments)}}();r({})})));case 8:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)}),fetchCoinPriceFromBackups:(A=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,c,l,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rootState,n=t.commit,t.dispatch,c=t.rootGetters,t.state,(l=c["metamask/networkConfig"]).smartContractPollTime,d=l.extraFeeOracle,f=l.supportExtraFee,r.metamask.netId,f){e.next=6;break}return n("SET_ETH_PRICE_LOADED",!0),e.abrupt("return");case 6:return e.abrupt("return",new Promise((function(e,t){var r=function(){var c=Object(o.a)(regeneratorRuntime.mark((function o(c){var l,f,k,T,h,E,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=c.retryAttempt,f=void 0===l?1:l,f++,o.prev=2,!(k=d.coinBackups)){o.next=20;break}return T=k[f%k.length],o.next=8,Object(m.a)(T);case 8:if(200!==(h=o.sent).status){o.next=19;break}return o.next=12,h.json();case 12:E=o.sent,v=E.data.priceUsd,n("SAVE_ETH_PRICE",v),n("SET_ETH_PRICE_LOADED",!0),e(v),o.next=20;break;case 19:throw Error("Fetch coin price failed");case 20:o.next=26;break;case 22:o.prev=22,o.t0=o.catch(2),console.info(o.t0),f>=3?t(o.t0):r({retryAttempt:f});case 26:case"end":return o.stop()}}),o,null,[[2,22]])})));return function(e){return c.apply(this,arguments)}}();r({})})));case 8:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)}),fetchTokenList:(x=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,m,f,k,T,h,E,v,y,w,S,x,A,O,_,R,N,C,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,o=t.commit,c=t.dispatch,l=t.rootGetters,t.state,m=r.oracleIndex,f=void 0===m?0:m,(k=l["metamask/networkConfig"]).smartContractPollTime,k.gasPrice,T=k.tokenOracleUrls,k.trc10TokenListOracleUrls,h=k.currencyName,E=k.networkName,v=n.metamask,y=v.netId,v.isFetching,w=v.ethAccount,v.tokens,S=v.balance,x=v.ethCoinName,y!=y){e.next=45;break}if(e.prev=5,null!=w){e.next=10;break}throw o("SET_WALLET_STATE",-4),f=20,Error("account not actived");case 10:return A=T[f%T.length],A+=w,e.next=14,fetch(A);case 14:if(200!==(O=e.sent).status){e.next=35;break}return e.next=18,O.json();case 18:if(!(_=e.sent).trc20token_balances&&!_.balances){e.next=32;break}R=[],N=_.trc20token_balances,C=_.balances,I=[],C.forEach((function(e){var t=e.tokenName,r=e.tokenDecimal,symbol=e.tokenAbbr,n=e.balance,o=e.tokenId;if("_"!=o&&!isNaN(o)&&(n=Object(d.a)(n).div(Object(d.a)(10).pow(parseInt(r))).toNumber())>0){var c={name:t,symbol:symbol,decimals:r,balance:n,displayBalance:n.toString(10),contractAddress:parseInt(o),isTrc10:!0};I.push(c)}})),R.push({symbol:h,name:E+x,balance:Object(d.a)(S).times(Object(d.a)(10).pow(6)).toString(10),displayBalance:S,contractAddress:"0x0000000000000000000000000000000000000000",decimals:"6",isETH:!0}),N.forEach((function(e){var t=e.tokenName,r=e.tokenDecimal,symbol=e.tokenAbbr,n=e.balance,o=e.tokenId;if("_"!=o&&(n=Object(d.a)(n).div(Object(d.a)(10).pow(parseInt(r))).toNumber())>0){var c={name:t,symbol:symbol,decimals:r,balance:n,displayBalance:n.toString(10),contractAddress:o};R.push(c)}})),I&&I.length&&(R=R.concat(I)),o("SAVE_TOKENS",R),o("SET_FETCHING",!1),e.next=33;break;case 32:throw Error("Fetch tokens failed");case 33:e.next=36;break;case 35:throw Error("Fetch tokens failed");case 36:e.next=43;break;case 38:e.prev=38,e.t0=e.catch(5),console.error(e.t0),++f<=20?c("fetchTokenList",{oracleIndex:f}):((R=[]).push({symbol:h,name:E+x,balance:Object(d.a)(S).times(Object(d.a)(10).pow(6)).toString(10),displayBalance:S,contractAddress:"0x0000000000000000000000000000000000000000",decimals:"6",isETH:!0}),o("SAVE_TOKENS",R),o("SET_FETCHING",!1));case 43:e.next=50;break;case 45:console.info(T),(R=[]).push({symbol:h,name:E+x,balance:Object(d.a)(S).times(Object(d.a)(10).pow(6)).toString(10),displayBalance:S,contractAddress:"0x0000000000000000000000000000000000000000",decimals:"6",isETH:!0}),o("SAVE_TOKENS",R),o("SET_FETCHING",!1);case 50:case"end":return e.stop()}}),e,null,[[5,38]])}))),function(e,t){return x.apply(this,arguments)}),fetchTrc10TokenList:(S=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k,T,h,E,v,y,w,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,o=t.commit,c=t.dispatch,l=t.rootGetters,t.state,d=r.oracleIndex,m=void 0===d?0:d,(f=l["metamask/networkConfig"]).smartContractPollTime,f.gasPrice,f.tokenOracleUrls,k=f.trc10TokenListOracleUrls,f.trc10StaticTokenDataOracleUrls,f.currencyName,f.networkName,T=n.metamask,h=T.netId,T.isFetching,T.ethAccount,T.tokens,T.balance,T.ethCoinName,h!=h){e.next=35;break}return e.prev=5,e.next=8,c("fetchTrc10TokenListFromGithub",{});case 8:return E=e.sent,v=k[m%k.length],v+=E.length.toString(),console.info(v),e.next=14,fetch(v);case 14:if(200!==(y=e.sent).status){e.next=22;break}return e.next=18,y.json();case 18:(w=e.sent).tokens&&(E=E.concat(w.tokens)),e.next=23;break;case 22:throw Error("Fetch trc10 tokens failed");case 23:S={},E.forEach((function(e){var t={name:e.name,symbol:e.abbr,decimals:e.decimal,contractAddress:e.tokenId};S[e.tokenId]=t})),o("SAVE_TRC10_TOKENS",S),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(5),console.error(e.t0),++m<=20&&c("fetchTrc10TokenList",{oracleIndex:m});case 33:e.next=35;break;case 35:case"end":return e.stop()}}),e,null,[[5,28]])}))),function(e,t){return S.apply(this,arguments)}),fetchTrc10TokenListFromGithub:(w=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k,T,h,E,v,y,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,t.commit,o=t.dispatch,c=t.rootGetters,t.state,l=r.oracleIndex,d=void 0===l?0:l,(m=c["metamask/networkConfig"]).smartContractPollTime,f=m.trc10StaticTokenDataOracleUrls,m.currencyName,m.networkName,k=n.metamask,T=k.netId,k.isFetching,k.ethAccount,k.tokens,k.balance,k.ethCoinName,T!=T){e.next=39;break}return e.prev=5,e.next=8,o("common/getCachedTrc10Tokens",{},{root:!0});case 8:if(!(h=e.sent).length){e.next=11;break}return e.abrupt("return",h);case 11:return E=f[d%f.length],e.next=14,fetch(E);case 14:if(200!==(v=e.sent).status){e.next=29;break}return e.next=18,v.json();case 18:if(!(y=e.sent).tokens){e.next=26;break}return w=y.tokens,e.next=23,o("common/saveTrc10Tokens",{trc10Tokens:w},{root:!0});case 23:return e.abrupt("return",w);case 26:throw Error("Fetch trc10 tokens failed");case 27:e.next=30;break;case 29:throw Error("Fetch trc10 tokens failed");case 30:e.next=37;break;case 32:e.prev=32,e.t0=e.catch(5),console.error(e.t0),++d<=20&&o("fetchTrc10TokenListFromGithub",{oracleIndex:d});case 37:e.next=39;break;case 39:case"end":return e.stop()}}),e,null,[[5,32]])}))),function(e,t){return w.apply(this,arguments)}),fetchGasPrice:(y=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,m,f,k,T,E,v,y,w,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rootState,o=t.commit,c=t.dispatch,l=t.rootGetters,t.state,d=r.oracleIndex,m=void 0===d?0:d,f=l["metamask/networkConfig"],k=f.smartContractPollTime,T=f.gasPrice,E=f.gasOracleUrls,v=n.metamask.netId,e.prev=4,1!==v){e.next=26;break}return e.next=8,fetch(E[m%E.length]);case 8:if(200!==(y=e.sent).status){e.next=22;break}return e.next=12,y.json();case 12:w=e.sent,S=h({},T),w.slow&&(S.low=Number(w.slow)+.5),w.safeLow&&(S.low=Number(w.safeLow)+.5),w.fast&&(S.fast=Number(w.fast)),w.standard&&(S.standard=Number(w.standard)),w.instant&&(S.instant=Number(w.instant)),o("SAVE_GAS_PRICE",S),e.next=23;break;case 22:throw Error("Fetch gasPrice failed");case 23:setTimeout((function(){return c("fetchGasPrice",{})}),1e3*k),e.next=27;break;case 26:o("SAVE_GAS_PRICE",T);case 27:e.next=34;break;case 29:e.prev=29,e.t0=e.catch(4),console.error(e.t0),m++,setTimeout((function(){return c("fetchGasPrice",{oracleIndex:m})}),1e3*k);case 34:case"end":return e.stop()}}),e,null,[[4,29]])}))),function(e,t){return y.apply(this,arguments)}),getTransactionReceipt:(v=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,t.rootGetters,t.rootState,n=t.dispatch,t.commit,c=r.txHash,e.abrupt("return",new Promise((function(e,t){var r=function(){var l=Object(o.a)(regeneratorRuntime.mark((function o(l){var d,m,f,k;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return d=l.retryAttempt,m=void 0===d?1:d,m++,o.prev=2,f={method:"eth_getTransactionReceipt",params:[c]},o.next=6,n("metamask/sendAsync",f,{root:!0});case 6:k=o.sent,e(k),o.next=13;break;case 10:o.prev=10,o.t0=o.catch(2),m>=2?t(o.t0):r({retryAttempt:m});case 13:case"end":return o.stop()}}),o,null,[[2,10]])})));return function(e){return l.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)}),getTransactionCount:(E=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,address;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,t.rootGetters,t.rootState,n=t.dispatch,t.commit,address=r.address,e.abrupt("return",new Promise((function(e,t){var r=function(){var c=Object(o.a)(regeneratorRuntime.mark((function o(c){var l,d,m,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l=c.retryAttempt,d=void 0===l?1:l,d++,o.prev=2,m={method:"eth_getTransactionCount",params:[address,"latest"]},o.next=6,n("metamask/sendAsync",m,{root:!0});case 6:f=o.sent,e(f),o.next=13;break;case 10:o.prev=10,o.t0=o.catch(2),d>=2?t(o.t0):r({retryAttempt:d});case 13:case"end":return o.stop()}}),o,null,[[2,10]])})));return function(e){return c.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)}),sendAsync:function(e,t){e.state;var r=e.getters,n=t.method,c=t.from,l=t.params;switch(r.netId){case 77:case 99:break;case 100:c=void 0}return new Promise(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,o){var d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getEthereumProvider();case 2:d=e.sent,console.log("sendAsync `method, from, params`",n,c,l);try{d.sendAsync({method:n,params:l,jsonrpc:"2.0",from:c},(function(e,r){e&&o(e),r.error?o(r.error):t(r.result)}))}catch(e){d.send({method:n,params:l,jsonrpc:"2.0",from:c},(function(e,r){e&&o(e),r.error?o(r.error):t(r.result)}))}case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}};t.default={namespaced:!0,state:function(){return{ethAccount:null,netId:1,currency:"TRX",domainData:{},balance:"0",address:{value:null,valid:!1},gasPrice:{fast:1,low:1,standard:1},providerName:"",networkName:"",tokens:[],tokensForTestnet:[],tokenAddress:"",isFetching:!0,ethCoinName:" TRON Native Currency",walletState:1,checkingTimes:0,trc10Tokens:{},ethPrice:0,ethPriceLoaded:!1,chainParameters:{},maxCpuTimeOfOneTx:80*Math.pow(10,4),energyFee:420,bandwidthFee:1e3,energyBalance:0}},getters:N,mutations:C,actions:I}}}]);